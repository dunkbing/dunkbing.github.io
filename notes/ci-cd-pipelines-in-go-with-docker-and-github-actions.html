<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta charSet="utf-8"/><meta name="description" content="Build CI/CD pipelines in Go with github actions and Docker"/><meta name="google-site-verification" content="EvBTnaMX5a54coVLUMXi9_87myajTYR_KF5j8T_Ag-E"/><title>Build CI/CD pipelines in Go with github actions and Docker</title><meta name="google" content="notranslate"/><link rel="canonical" href="https://dunkbing.github.io/notes/ci-cd-pipelines-in-go-with-docker-and-github-actions"/><meta property="og:url" content="https://dunkbing.github.io/notes/ci-cd-pipelines-in-go-with-docker-and-github-actions"/><meta property="og:type" content="article"/><meta property="og:image" content="https://dunkbing.github.io/images/gopher-github-actions.jpeg"/><meta property="og:title" content="Build CI/CD pipelines in Go with github actions and Docker"/><meta property="og:description" content="Build CI/CD pipelines in Go with github actions and Docker"/><meta property="og:site_name" content="dunkbing - FullStack Developer"/><meta property="article:author" content="https://www.facebook.com/dunkbingg"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@dunkbingg"/><meta name="twitter:creator" content="@dunkbingg"/><meta name="twitter:title" content="Build CI/CD pipelines in Go with github actions and Docker"/><meta name="twitter:description" content="Build CI/CD pipelines in Go with github actions and Docker"/><meta name="twitter:image" content="https://dunkbing.github.io/images/gopher-github-actions.jpeg"/><meta property="article:published_time" content="2024-01-30"/><meta property="article:modified_time" content="2024-01-30"/><link rel="preload" href="/images/gopher-github-actions.jpeg" as="image" fetchpriority="high"/><meta name="next-head-count" content="23"/><link id="favicon" rel="shortcut icon" href="/favicon.ico"/><script async="" src="https://storage.ko-fi.com/cdn/scripts/overlay-widget.js"></script><script>
                kofiWidgetOverlay.draw('dunkbing', {
                  'type': 'floating-chat',
                  'floating-chat.donateButton.text': 'Support me',
                  'floating-chat.donateButton.background-color': '#00b9fe',
                  'floating-chat.donateButton.text-color': '#fff'
                });</script><link rel="preload" href="/_next/static/css/8c75f44180486599.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/8c75f44180486599.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-fd8027ecb5121007.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-a4b9f4216022cc2d.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-5c8493ea547f384f.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-f89a91ed3fc6ac98.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/382-82956fe95df28f52.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/379-c1f26cb039f7bc0b.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/573-690f4d06ded758e9.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/notes/%5Bslug%5D-6999eaa204011583.js" defer="" crossorigin=""></script><script src="/_next/static/HqLUniL5FVtfX-QYTfP9O/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/HqLUniL5FVtfX-QYTfP9O/_ssgManifest.js" defer="" crossorigin=""></script></head><body class="bg-gray-900 text-white"><div id="__next"><header class="sticky top-0 z-50"><div class="max-w-4xl px-8 mx-auto header bg-gray-900 border-b-2 border-yellow-600"><div class="flex items-center justify-between py-4"><nav class="font-bold text-xl font-mono text-gray-200 py-2"><a class="mr-5" href="/">Home</a><a class="px-6" href="/notes">Notes</a><a class="px-6" href="/golang">Golang</a></nav></div></div></header><main><div class="max-w-4xl px-8 py-4 mx-auto"><article class="flex flex-col items-center font-mono"><h1 class="mb-3 text-white">Build CI/CD pipelines in Go with github actions and Docker</h1><p class="mb-3 text-sm text-gray-400">Last updated: <!-- -->January 30, 2024</p><div class="prose-dark w-5/6"><br/>
<img alt="Gopher" fetchpriority="high" width="1024" height="1024" decoding="async" data-nimg="1" style="color:transparent" src="/images/gopher-github-actions.jpeg"/>
<br/>
<p>This tutorial will show you how to setup a CI/CD pipeline using GitHub Actions. The pipeline will test, build and publish a Go app to Docker Hub when changes are pushed to a GitHub repository.</p>
<h2 id="overview"><a aria-hidden="true" tabindex="-1" href="#overview"><span class="icon icon-link"></span></a><a href="#overview"></a>Overview</h2>
<p>Here is an overview of what&#x27;s in this guide:</p>
<ul>
<li>We start by creating a simple console app in Go that prints Hello World along with the version number of the app.</li>
<li>We will create a GitHub repository and assign Docker Hub credentials using the Secrets feature of GitHub.</li>
<li>We will create a GitHub workflow that runs Go tests each time a change is pushed to the main branch. The workflow will be configured to build a Docker image and push it to Docker Hub when a tag is pushed to the repository.</li>
<li>The workflow will extract a version number from a Git tag and assign it to a Go variable at build time so the latest version is printed when the app is run.</li>
<li>We will see the workflows in action. First by seeing what happens when we push code that fails tests. We will fix the code and see it pass, then we will see what happens when we push a tag.</li>
</ul>
<h1 id="1-create-go-project"><a aria-hidden="true" tabindex="-1" href="#1-create-go-project"><span class="icon icon-link"></span></a><a href="#1-create-go-project"></a>1. Create Go Project</h1>
<p>First let&#x27;s create a simple Go program that prints out Hello World along with the version number of our app.
Create a folder to store our files:</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">mkdir</span> ~/golang-pipeline
$ <span class="token builtin class-name">cd</span> ~/golang-pipeline
</code></pre>
<p>Create <strong>main.go</strong> and <strong>main_test.go</strong></p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">touch</span> main.go
$ <span class="token function">touch</span> main_test.go
</code></pre>
<p>Add the following code to <strong>main.go</strong></p>
<pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">var</span> version <span class="token operator">=</span> <span class="token string">&quot;dev&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Version: %s\n&quot;</span><span class="token punctuation">,</span> version<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello Golang&quot;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Note: the version variable is assigned the string <code>dev</code> and the string returned by the <code>hello</code> function is intentionally wrong so that our tests fail. Later we will see how the GitHub action can be configured to automatically replace the version string at build time.</p>
<p>Add the following code to <strong>main_test.go</strong></p>
<pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;testing&quot;</span>

<span class="token keyword">func</span> <span class="token function">TestHello</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    want <span class="token operator">:=</span> <span class="token string">&quot;Hello Golang&quot;</span>

    got <span class="token operator">:=</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> want <span class="token operator">!=</span> got <span class="token punctuation">{</span>
        t<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;want %s, got %s\n&quot;</span><span class="token punctuation">,</span> want<span class="token punctuation">,</span> got<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Make sure our tests run and fail by running:</p>
<pre class="language-bash"><code class="language-bash">$ go <span class="token builtin class-name">test</span>

--- FAIL: TestHello <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    main_test.go:9: want Hello Golang, got Hello Golang
FAIL
<span class="token builtin class-name">exit</span> status <span class="token number">1</span>
FAIL    hello   <span class="token number">0</span>.003s
</code></pre>
<p>It fails because we made the return value of the hello function wrong on purpose so we can test the CI/CD pipeline catches errors.</p>
<p>We can also test the app runs by running:</p>
<pre class="language-bash"><code class="language-bash">$ go run main.go

Version: dev
Hello golang
</code></pre>
<p>Notice it prints out <strong>dev</strong> for the version. When we run the release version from the published image on Docker Hub, we will see the version number that was tagged when pushing a release to the GitHub repo.</p>
<h1 id="2-create-github-repository"><a aria-hidden="true" tabindex="-1" href="#2-create-github-repository"><span class="icon icon-link"></span></a><a href="#2-create-github-repository"></a>2. Create GitHub Repository</h1>
<p>Login to your GitHub account and create a new repository. For the following example I have created a new public repo (exmple <a href="https://github.com/Ja7ad/golang-pipeline">golang-pipeline</a>)</p>
<h1 id="3-assign-docker-hub-credentials-as-secrets"><a aria-hidden="true" tabindex="-1" href="#3-assign-docker-hub-credentials-as-secrets"><span class="icon icon-link"></span></a><a href="#3-assign-docker-hub-credentials-as-secrets"></a>3. Assign Docker Hub Credentials as Secrets</h1>
<p>For this step you will need to login to your Docker Hub account and generate an <a href="https://hub.docker.com/settings/security">access token</a>. Once you&#x27;ve done that, navigate to the <strong>Settings</strong> screen of the GitHub repository then click on <strong>Secrets</strong>.</p>
<p><img src="/images/notes/create_secret_docker_username_ga.png" alt="Create Secret DOCKER_USERNAME"/>
<em>Create Secret DOCKER_USERNAME</em></p>
<p><img src="/images/notes/create_secret_docker_access_token_ga.png" alt="Create Secret DOCKER_ACCESS_TOKEN"/>
<em>Create Secret DOCKER_ACCESS_TOKEN</em></p>
<p><img src="/images/notes/secret_for_pipeline.png" alt="Secrets for pipeline"/>
<em>Secrets for pipeline</em></p>
<h1 id="4-create-github-workflow"><a aria-hidden="true" tabindex="-1" href="#4-create-github-workflow"><span class="icon icon-link"></span></a><a href="#4-create-github-workflow"></a>4. Create GitHub Workflow</h1>
<p>We are now ready to create the GitHub workflow. Create a folder inside your repository called <code>.github/workflows</code> and add a file called <strong>push.yml</strong>.</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">mkdir</span> -p .github/workflows
$ <span class="token function">touch</span> .github/workflows/push.yml
</code></pre>
<p>Add the following config to the <strong>push.yml</strong> file:</p>
<pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> golang<span class="token punctuation">-</span>pipeline
<span class="token key atrule">on</span><span class="token punctuation">:</span> push
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
    <span class="token key atrule">test</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">if</span><span class="token punctuation">:</span> github.ref == &#x27;refs/heads/main&#x27; <span class="token punctuation">|</span><span class="token punctuation">|</span> startsWith(github.ref<span class="token punctuation">,</span> &#x27;refs/tags&#x27;)
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Run Unit Tests
        <span class="token key atrule">run</span><span class="token punctuation">:</span> go test

    <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">needs</span><span class="token punctuation">:</span> test
    <span class="token key atrule">if</span><span class="token punctuation">:</span> startsWith(github.ref<span class="token punctuation">,</span> &#x27;refs/tags&#x27;)
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Extract Version
        <span class="token key atrule">id</span><span class="token punctuation">:</span> version_step
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
            echo &quot;##[set-output name=version;]VERSION=${GITHUB_REF#$&quot;refs/tags/v&quot;}&quot;
            echo &quot;##[set-output name=version_tag;]$GITHUB_REPOSITORY:${GITHUB_REF#$&quot;refs/tags/v&quot;}&quot;
            echo &quot;##[set-output name=latest_tag;]$GITHUB_REPOSITORY:latest&quot;</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Print Version
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
            echo ${{steps.version_step.outputs.version_tag}}
            echo ${{steps.version_step.outputs.latest_tag}}</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set up QEMU
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/setup<span class="token punctuation">-</span>qemu<span class="token punctuation">-</span>action@v1

        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set up Docker Buildx
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/setup<span class="token punctuation">-</span>buildx<span class="token punctuation">-</span>action@v1

        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Login to DockerHub
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/login<span class="token punctuation">-</span>action@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
            <span class="token key atrule">username</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.DOCKERHUB_USERNAME <span class="token punctuation">}</span><span class="token punctuation">}</span>
            <span class="token key atrule">password</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.DOCKERHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>

        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> PrepareReg Names
        <span class="token key atrule">id</span><span class="token punctuation">:</span> read<span class="token punctuation">-</span>docker<span class="token punctuation">-</span>image<span class="token punctuation">-</span>identifiers
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
            echo VERSION_TAG=$(echo ${{ steps.version_step.outputs.version_tag }} | tr &#x27;[:upper:]&#x27; &#x27;[:lower:]&#x27;) &gt;&gt; $GITHUB_ENV
            echo LASTEST_TAG=$(echo ${{ steps.version_step.outputs.latest_tag  }} | tr &#x27;[:upper:]&#x27; &#x27;[:lower:]&#x27;) &gt;&gt; $GITHUB_ENV</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build and push
        <span class="token key atrule">id</span><span class="token punctuation">:</span> docker_build
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/build<span class="token punctuation">-</span>push<span class="token punctuation">-</span>action@v2
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
            <span class="token key atrule">push</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
            <span class="token key atrule">tags</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
            ${{env.VERSION_TAG}}
            ${{env.LASTEST_TAG}}
            build-args: |
            ${{steps.version_step.outputs.version}}</span>
</code></pre>
<p>Replace Variables in the environment with <strong>$</strong> ( <a href="https://github.com/Ja7ad/golang-pipeline/blob/main/.github/workflows/push.yml">example push.yml</a> )</p>
<p>The workflow config is quite simple. You will notice there are two jobs, one called <strong>test</strong> and one called <strong>deploy</strong>. The <strong>test</strong> job has one step that uses an if to make sure it only runs when changes are pushed to the main branch or a tag is pushed.</p>
<p>The deploy job requires the test job to run first so that if the tests fail, the Docker image will not be built. If the test job does pass, the remaining steps will run. The first step extracts the version number from a git tag that has the following format <strong>v1.0.0</strong>.</p>
<p>The next two steps setup the environment so that Docker images can be built. Finally, a step is run that signs into your Docker Hub account using the credentials stored in GitHub Secrets, then the Docker image is built and pushed to Docker Hub.</p>
<p>You Can see you run action pipeline in <strong><a href="https://github.com/USERNAME/golang-pipeline/actions">https://github.com/USERNAME/golang-pipeline/actions</a></strong> your repo.</p>
<h1 id="5-create-dockerfile"><a aria-hidden="true" tabindex="-1" href="#5-create-dockerfile"><span class="icon icon-link"></span></a><a href="#5-create-dockerfile"></a>5. Create Dockerfile</h1>
<p>Now we need to create a <strong>Dockerfile</strong> for the GitHub action to use when building the image. Create a file called <strong>Dockerfile</strong> at the root of the repo.</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">touch</span> Dockerfile
</code></pre>
<p>Add the following to the <strong>Dockerfile</strong>:</p>
<pre class="language-dockerfile"><code class="language-Dockerfile"><span class="token keyword">FROM</span> golang<span class="token punctuation">:</span>1.16.4<span class="token punctuation">-</span>buster AS builder

<span class="token keyword">ARG</span> VERSION=dev

<span class="token keyword">WORKDIR</span> /go/src/app
<span class="token keyword">COPY</span> main.go .
<span class="token keyword">RUN</span> go build <span class="token punctuation">-</span>o main <span class="token punctuation">-</span>ldflags=<span class="token punctuation">-</span>X=main.version=$<span class="token punctuation">{</span>VERSION<span class="token punctuation">}</span> main.go

<span class="token keyword">FROM</span> debian<span class="token punctuation">:</span>buster<span class="token punctuation">-</span>slim
<span class="token keyword">COPY</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>from=builder /go/src/app/main /go/bin/main
<span class="token keyword">ENV</span> PATH=<span class="token string">&quot;/go/bin:${PATH}&quot;</span>
<span class="token keyword">CMD</span> <span class="token punctuation">[</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">]</span>
</code></pre>
<p>The config above uses a multi-stage build process to build the Go app then copy it to a slim Debian image. If you want to make the image smaller, you can change it to alpine or scratch.</p>
<p>Let&#x27;s test the <strong>Dockerfile</strong> by building it with the following command:</p>
<pre class="language-bash"><code class="language-bash">    $ docker build -t golang-pipeline:dev <span class="token builtin class-name">.</span>

    Sending build context to Docker daemon  <span class="token number">114</span>.2kB
    Step <span class="token number">1</span>/9 <span class="token builtin class-name">:</span> FROM golang:1.16.4-buster AS builder
    <span class="token number">1.16</span>.4-buster: Pulling from library/golang
    d960726af2be: Pull complete
    e8d62473a22d: Pull complete
    8962bc0fad55: Pull complete
    65d943ee54c1: Pull complete
    f2253e6fbefa: Pull complete
    6d7fa7c7d5d3: Pull complete
    e2e442f7f89f: Pull complete
    Digest: sha256:ab32429d40c1b734ed4f036838ac516352182f9414563478fa88a1553c4a4414
    Status: Downloaded newer image <span class="token keyword">for</span> golang:1.16.4-buster
     ---<span class="token operator">&gt;</span> 96129f3766cf
    Step <span class="token number">2</span>/9 <span class="token builtin class-name">:</span> ARG <span class="token assign-left variable">VERSION</span><span class="token operator">=</span>dev
     ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 819610ae34de
    Removing intermediate container 819610ae34de
     ---<span class="token operator">&gt;</span> 9eec806043be
    Step <span class="token number">3</span>/9 <span class="token builtin class-name">:</span> WORKDIR /go/src/app
     ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 46c0cf6a36b4
    Removing intermediate container 46c0cf6a36b4
     ---<span class="token operator">&gt;</span> 1f1f66dfcc4f
    Step <span class="token number">4</span>/9 <span class="token builtin class-name">:</span> COPY main.go <span class="token builtin class-name">.</span>
     ---<span class="token operator">&gt;</span> 963a3bcf262b
    Step <span class="token number">5</span>/9 <span class="token builtin class-name">:</span> RUN go build -o main -ldflags<span class="token operator">=</span>-X<span class="token operator">=</span>main.version<span class="token operator">=</span><span class="token variable">${VERSION}</span> main.go
     ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> c18447aa254a
    Removing intermediate container c18447aa254a
     ---<span class="token operator">&gt;</span> 3d5364678624
    Step <span class="token number">6</span>/9 <span class="token builtin class-name">:</span> FROM debian:buster-slim
    buster-slim: Pulling from library/debian
    69692152171a: Pull complete
    Digest: sha256:f077cd32bfea6c4fa8ddeea05c53b27e90c7fad097e2011c9f5f11a8668f8db4
    Status: Downloaded newer image <span class="token keyword">for</span> debian:buster-slim
     ---<span class="token operator">&gt;</span> 80b9e7aadac5
    Step <span class="token number">7</span>/9 <span class="token builtin class-name">:</span> COPY --from<span class="token operator">=</span>builder /go/src/app/main /go/bin/main
     ---<span class="token operator">&gt;</span> f96694436dca
    Step <span class="token number">8</span>/9 <span class="token builtin class-name">:</span> ENV <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token string">&quot;/go/bin:<span class="token variable">${<span class="token environment constant">PATH</span>}</span>&quot;</span>
     ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 0423a0a1b60a
    Removing intermediate container 0423a0a1b60a
     ---<span class="token operator">&gt;</span> 8ac59bcbe805
    Step <span class="token number">9</span>/9 <span class="token builtin class-name">:</span> CMD <span class="token punctuation">[</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">]</span>
     ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 1491bcf193c6
    Removing intermediate container 1491bcf193c6
     ---<span class="token operator">&gt;</span> 190ba9407211
    Successfully built 190ba9407211
    Successfully tagged golang-pipeline:dev
</code></pre>
<p>Now run the image and see if it prints the incorrect string <strong>Hello Golang</strong>:</p>
<pre class="language-bash"><code class="language-bash">    $ docker run --rm golang-pipeline:dev

    Version: dev
    Hello golang
</code></pre>
<p>We can assign a version to the image by using <code>--build-arg VERSION=1.0.0</code> while building the image. For example:</p>
<pre class="language-bash"><code class="language-bash">    $ docker build -t golang-pipeline:1.0.0 <span class="token builtin class-name">.</span> --build-arg <span class="token assign-left variable">VERSION</span><span class="token operator">=</span><span class="token number">1.0</span>.0

    Sending build context to Docker daemon  <span class="token number">114</span>.2kB
    Step <span class="token number">1</span>/9 <span class="token builtin class-name">:</span> FROM golang:1.16.4-buster AS builder
     ---<span class="token operator">&gt;</span> 96129f3766cf
    Step <span class="token number">2</span>/9 <span class="token builtin class-name">:</span> ARG <span class="token assign-left variable">VERSION</span><span class="token operator">=</span>dev
     ---<span class="token operator">&gt;</span> Using cache
     ---<span class="token operator">&gt;</span> 9eec806043be
    Step <span class="token number">3</span>/9 <span class="token builtin class-name">:</span> WORKDIR /go/src/app
     ---<span class="token operator">&gt;</span> Using cache
     ---<span class="token operator">&gt;</span> 1f1f66dfcc4f
    Step <span class="token number">4</span>/9 <span class="token builtin class-name">:</span> COPY main.go <span class="token builtin class-name">.</span>
     ---<span class="token operator">&gt;</span> Using cache
     ---<span class="token operator">&gt;</span> 963a3bcf262b
    Step <span class="token number">5</span>/9 <span class="token builtin class-name">:</span> RUN go build -o main -ldflags<span class="token operator">=</span>-X<span class="token operator">=</span>main.version<span class="token operator">=</span><span class="token variable">${VERSION}</span> main.go
     ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 352fb8de7969
    Removing intermediate container 352fb8de7969
     ---<span class="token operator">&gt;</span> 0950776088fa
    Step <span class="token number">6</span>/9 <span class="token builtin class-name">:</span> FROM debian:buster-slim
     ---<span class="token operator">&gt;</span> 80b9e7aadac5
    Step <span class="token number">7</span>/9 <span class="token builtin class-name">:</span> COPY --from<span class="token operator">=</span>builder /go/src/app/main /go/bin/main
     ---<span class="token operator">&gt;</span> 91938ce4f326
    Step <span class="token number">8</span>/9 <span class="token builtin class-name">:</span> ENV <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token string">&quot;/go/bin:<span class="token variable">${<span class="token environment constant">PATH</span>}</span>&quot;</span>
     ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 44541fe9de77
    Removing intermediate container 44541fe9de77
     ---<span class="token operator">&gt;</span> c8924b6b45b3
    Step <span class="token number">9</span>/9 <span class="token builtin class-name">:</span> CMD <span class="token punctuation">[</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">]</span>
     ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 424b93b94419
    Removing intermediate container 424b93b94419
     ---<span class="token operator">&gt;</span> 9da417e7399b
    Successfully built 9da417e7399b
    Successfully tagged golang-pipeline:1.0.0
</code></pre>
<p>The docker image built can be found here:</p>
<pre class="language-bash"><code class="language-bash">    $ docker images

    REPOSITORY                TAG             IMAGE ID       CREATED          SIZE
    golang-pipeline           <span class="token number">1.0</span>.0           9da417e7399b   <span class="token number">22</span> seconds ago   <span class="token number">71</span>.2MB
    golang-pipeline           dev             190ba9407211   <span class="token number">3</span> minutes ago    <span class="token number">71</span>.2MB
    golang                    <span class="token number">1.16</span>.4-buster   96129f3766cf   <span class="token number">2</span> weeks ago      862MB
    debian                    buster-slim     80b9e7aadac5   <span class="token number">2</span> weeks ago      <span class="token number">69</span>.2MB
</code></pre>
<p>The reason this works, is because we use <code>-ldflags</code> to modify the version variable at compile time. The <code>--build-arg</code> assigns the version to <strong>VERSION</strong> and is used in the following line:</p>
<pre class="language-bash"><code class="language-bash">    RUN go build -o main -ldflags<span class="token operator">=</span>-X<span class="token operator">=</span>main.version<span class="token operator">=</span><span class="token variable">${VERSION}</span> main.go
</code></pre>
<p>Okay, we are now ready to push our code to the GitHub repository.</p>
<h1 id="6-push-code-to-main"><a aria-hidden="true" tabindex="-1" href="#6-push-code-to-main"><span class="icon icon-link"></span></a><a href="#6-push-code-to-main"></a>6. Push Code to Main</h1>
<p>Now that we know our project builds and we have created a repository, we are ready to push our code to the main branch. Letâ€™s initialise Git, commit our changes, add the origin, and push the changes by running the following commands (replace the repo URL with your own):</p>
<pre class="language-bash"><code class="language-bash">    $ <span class="token function">git</span> init
    $ <span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
    $ <span class="token function">git</span> commit -m <span class="token string">&quot;first commit&quot;</span>
    $ <span class="token function">git</span> remote <span class="token function">add</span> origin git@github.com:USERNAME/golang-pipeline
    $ <span class="token function">git</span> branch -M main
    $ <span class="token function">git</span> push -u origin main
</code></pre>
<h1 id="7-check-build-failed"><a aria-hidden="true" tabindex="-1" href="#7-check-build-failed"><span class="icon icon-link"></span></a><a href="#7-check-build-failed"></a>7. Check Build Failed</h1>
<p>Go to your GitHub repository and click <strong>Actions</strong>. We should see the GitHub action running. Since we are pushing to the main branch, it will run the <strong>test</strong> job and it should fail.</p>
<p><img src="/images/notes/ga_build_fail.png" alt="Github Action test fail_"/>
<em>Github Action test fail</em></p>
<h1 id="8-fix-code-so-test-passes"><a aria-hidden="true" tabindex="-1" href="#8-fix-code-so-test-passes"><span class="icon icon-link"></span></a><a href="#8-fix-code-so-test-passes"></a>8. Fix Code so Test Passes</h1>
<p>Let&#x27;s fix the broken test.
Open <strong>main.go</strong> and modify the return value of the <code>hello</code> function so that it returns <code>Hello Golang</code>.</p>
<pre class="language-bash"><code class="language-bash">    $ go <span class="token builtin class-name">test</span>

    PASS
    ok      hello   <span class="token number">0</span>.003s


Commit and push the changes.

    $ <span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
    $ <span class="token function">git</span> commit - <span class="token string">&quot;Fix hello function return value&quot;</span>
    $ <span class="token function">git</span> push
</code></pre>
<p>The GitHub action should run again and now the test will pass.</p>
<p><img src="/images/notes/ga_test_successfully.png" alt="Github Action test fail_"/>
<em>Github Action test successfully</em></p>
<p><img src="/images/notes/ga_status.png" alt="Github Action test fail_"/>
<em>Github Action status</em></p>
<h1 id="9-push-tag"><a aria-hidden="true" tabindex="-1" href="#9-push-tag"><span class="icon icon-link"></span></a><a href="#9-push-tag"></a>9. Push Tag</h1>
<p>Now that we know the test passes, let&#x27;s push a release tag. We will tag this version as <strong>v1.0.0</strong></p>
<pre class="language-bash"><code class="language-bash">    $ <span class="token function">git</span> tag v1.0.0
    $ <span class="token function">git</span> push --tags
</code></pre>
<p>After pushing the tags, the GitHub action will run again and this time it will build the Docker image and push it to your Docker Hub repository.</p></div></article></div></main><footer class="py-8"><div class="max-w-4xl px-8 mx-auto">Built by<!-- --> <a class="font-bold text-white" target="_blank" href="https://github.com/dunkbing">dunkbing</a> -<a class="font-bold text-white underline ml-1" target="_blank" href="https://github.com/dunkbing/dunkbing.github.io">View source</a></div></footer></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h2: \"h2\",\n    a: \"a\",\n    span: \"span\",\n    ul: \"ul\",\n    li: \"li\",\n    h1: \"h1\",\n    pre: \"pre\",\n    code: \"code\",\n    strong: \"strong\",\n    img: \"img\",\n    em: \"em\"\n  }, _provideComponents(), props.components), {Image} = _components;\n  if (!Image) _missingMdxReference(\"Image\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(\"br\", {}), \"\\n\", _jsx(Image, {\n      alt: `Gopher`,\n      src: `/images/gopher-github-actions.jpeg`,\n      priority: true,\n      width: 1024,\n      height: 1024\n    }), \"\\n\", _jsx(\"br\", {}), \"\\n\", _jsx(_components.p, {\n      children: \"This tutorial will show you how to setup a CI/CD pipeline using GitHub Actions. The pipeline will test, build and publish a Go app to Docker Hub when changes are pushed to a GitHub repository.\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"overview\",\n      children: [_jsx(_components.a, {\n        \"aria-hidden\": \"true\",\n        tabIndex: \"-1\",\n        href: \"#overview\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), _jsx(_components.a, {\n        href: \"#overview\"\n      }), \"Overview\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Here is an overview of what's in this guide:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"We start by creating a simple console app in Go that prints Hello World along with the version number of the app.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"We will create a GitHub repository and assign Docker Hub credentials using the Secrets feature of GitHub.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"We will create a GitHub workflow that runs Go tests each time a change is pushed to the main branch. The workflow will be configured to build a Docker image and push it to Docker Hub when a tag is pushed to the repository.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"The workflow will extract a version number from a Git tag and assign it to a Go variable at build time so the latest version is printed when the app is run.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"We will see the workflows in action. First by seeing what happens when we push code that fails tests. We will fix the code and see it pass, then we will see what happens when we push a tag.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.h1, {\n      id: \"1-create-go-project\",\n      children: [_jsx(_components.a, {\n        \"aria-hidden\": \"true\",\n        tabIndex: \"-1\",\n        href: \"#1-create-go-project\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), _jsx(_components.a, {\n        href: \"#1-create-go-project\"\n      }), \"1. Create Go Project\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"First let's create a simple Go program that prints out Hello World along with the version number of our app.\\nCreate a folder to store our files:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"$ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"mkdir\"\n        }), \" ~/golang-pipeline\\n$ \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \"cd\"\n        }), \" ~/golang-pipeline\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Create \", _jsx(_components.strong, {\n        children: \"main.go\"\n      }), \" and \", _jsx(_components.strong, {\n        children: \"main_test.go\"\n      })]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"$ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"touch\"\n        }), \" main.go\\n$ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"touch\"\n        }), \" main_test.go\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Add the following code to \", _jsx(_components.strong, {\n        children: \"main.go\"\n      })]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-go\",\n      children: _jsxs(_components.code, {\n        className: \"language-go\",\n        children: [_jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"package\"\n        }), \" main\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"fmt\\\"\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"var\"\n        }), \" version \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"dev\\\"\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"func\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"main\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n    fmt\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token function\",\n          children: \"Printf\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"Version: %s\\\\n\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" version\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \"\\n    fmt\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token function\",\n          children: \"Println\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token function\",\n          children: \"hello\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"func\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"hello\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token builtin\",\n          children: \"string\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"return\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"Hello Golang\\\"\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Note: the version variable is assigned the string \", _jsx(_components.code, {\n        children: \"dev\"\n      }), \" and the string returned by the \", _jsx(_components.code, {\n        children: \"hello\"\n      }), \" function is intentionally wrong so that our tests fail. Later we will see how the GitHub action can be configured to automatically replace the version string at build time.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Add the following code to \", _jsx(_components.strong, {\n        children: \"main_test.go\"\n      })]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-go\",\n      children: _jsxs(_components.code, {\n        className: \"language-go\",\n        children: [_jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"package\"\n        }), \" main\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"import\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"testing\\\"\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"func\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"TestHello\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), \"t \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"*\"\n        }), \"testing\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), \"T\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n    want \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":=\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"Hello Golang\\\"\"\n        }), \"\\n\\n    got \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":=\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"hello\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \"\\n\\n    \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"if\"\n        }), \" want \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"!=\"\n        }), \" got \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n        t\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token function\",\n          children: \"Fatalf\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"want %s, got %s\\\\n\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" want\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" got\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Make sure our tests run and fail by running:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"$ go \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \"test\"\n        }), \"\\n\\n--- FAIL: TestHello \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token number\",\n          children: \"0\"\n        }), \".00s\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \"\\n    main_test.go:9: want Hello Golang, got Hello Golang\\nFAIL\\n\", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \"exit\"\n        }), \" status \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"1\"\n        }), \"\\nFAIL    hello   \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"0\"\n        }), \".003s\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"It fails because we made the return value of the hello function wrong on purpose so we can test the CI/CD pipeline catches errors.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We can also test the app runs by running:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsx(_components.code, {\n        className: \"language-bash\",\n        children: \"$ go run main.go\\n\\nVersion: dev\\nHello golang\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Notice it prints out \", _jsx(_components.strong, {\n        children: \"dev\"\n      }), \" for the version. When we run the release version from the published image on Docker Hub, we will see the version number that was tagged when pushing a release to the GitHub repo.\"]\n    }), \"\\n\", _jsxs(_components.h1, {\n      id: \"2-create-github-repository\",\n      children: [_jsx(_components.a, {\n        \"aria-hidden\": \"true\",\n        tabIndex: \"-1\",\n        href: \"#2-create-github-repository\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), _jsx(_components.a, {\n        href: \"#2-create-github-repository\"\n      }), \"2. Create GitHub Repository\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Login to your GitHub account and create a new repository. For the following example I have created a new public repo (exmple \", _jsx(_components.a, {\n        href: \"https://github.com/Ja7ad/golang-pipeline\",\n        children: \"golang-pipeline\"\n      }), \")\"]\n    }), \"\\n\", _jsxs(_components.h1, {\n      id: \"3-assign-docker-hub-credentials-as-secrets\",\n      children: [_jsx(_components.a, {\n        \"aria-hidden\": \"true\",\n        tabIndex: \"-1\",\n        href: \"#3-assign-docker-hub-credentials-as-secrets\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), _jsx(_components.a, {\n        href: \"#3-assign-docker-hub-credentials-as-secrets\"\n      }), \"3. Assign Docker Hub Credentials as Secrets\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For this step you will need to login to your Docker Hub account and generate an \", _jsx(_components.a, {\n        href: \"https://hub.docker.com/settings/security\",\n        children: \"access token\"\n      }), \". Once you've done that, navigate to the \", _jsx(_components.strong, {\n        children: \"Settings\"\n      }), \" screen of the GitHub repository then click on \", _jsx(_components.strong, {\n        children: \"Secrets\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.img, {\n        src: \"/images/notes/create_secret_docker_username_ga.png\",\n        alt: \"Create Secret DOCKER_USERNAME\"\n      }), \"\\n\", _jsx(_components.em, {\n        children: \"Create Secret DOCKER_USERNAME\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.img, {\n        src: \"/images/notes/create_secret_docker_access_token_ga.png\",\n        alt: \"Create Secret DOCKER_ACCESS_TOKEN\"\n      }), \"\\n\", _jsx(_components.em, {\n        children: \"Create Secret DOCKER_ACCESS_TOKEN\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.img, {\n        src: \"/images/notes/secret_for_pipeline.png\",\n        alt: \"Secrets for pipeline\"\n      }), \"\\n\", _jsx(_components.em, {\n        children: \"Secrets for pipeline\"\n      })]\n    }), \"\\n\", _jsxs(_components.h1, {\n      id: \"4-create-github-workflow\",\n      children: [_jsx(_components.a, {\n        \"aria-hidden\": \"true\",\n        tabIndex: \"-1\",\n        href: \"#4-create-github-workflow\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), _jsx(_components.a, {\n        href: \"#4-create-github-workflow\"\n      }), \"4. Create GitHub Workflow\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We are now ready to create the GitHub workflow. Create a folder inside your repository called \", _jsx(_components.code, {\n        children: \".github/workflows\"\n      }), \" and add a file called \", _jsx(_components.strong, {\n        children: \"push.yml\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"$ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"mkdir\"\n        }), \" -p .github/workflows\\n$ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"touch\"\n        }), \" .github/workflows/push.yml\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Add the following config to the \", _jsx(_components.strong, {\n        children: \"push.yml\"\n      }), \" file:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-yaml\",\n      children: _jsxs(_components.code, {\n        className: \"language-yaml\",\n        children: [_jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"name\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" golang\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"pipeline\\n\", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"on\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" push\\n\", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"jobs\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"test\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"runs-on\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" ubuntu\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"latest\\n    \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"if\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" github.ref == 'refs/heads/main' \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"|\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"|\"\n        }), \" startsWith(github.ref\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" 'refs/tags')\\n    \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"steps\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"uses\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" actions/checkout@v2\\n        \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"name\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" Run Unit Tests\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"run\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" go test\\n\\n    \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"deploy\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \"\\n    \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"runs-on\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" ubuntu\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"latest\\n    \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"needs\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" test\\n    \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"if\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" startsWith(github.ref\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" 'refs/tags')\\n    \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"steps\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"name\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" Extract Version\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"id\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" version_step\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"run\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"|\"\n        }), _jsx(_components.span, {\n          className: \"token scalar string\",\n          children: \"\\n            echo \\\"##[set-output name=version;]VERSION=${GITHUB_REF#$\\\"refs/tags/v\\\"}\\\"\\n            echo \\\"##[set-output name=version_tag;]$GITHUB_REPOSITORY:${GITHUB_REF#$\\\"refs/tags/v\\\"}\\\"\\n            echo \\\"##[set-output name=latest_tag;]$GITHUB_REPOSITORY:latest\\\"\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"name\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" Print Version\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"run\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"|\"\n        }), _jsx(_components.span, {\n          className: \"token scalar string\",\n          children: \"\\n            echo ${{steps.version_step.outputs.version_tag}}\\n            echo ${{steps.version_step.outputs.latest_tag}}\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"name\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" Set up QEMU\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"uses\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" docker/setup\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"qemu\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"action@v1\\n\\n        \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"name\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" Set up Docker Buildx\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"uses\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" docker/setup\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"buildx\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"action@v1\\n\\n        \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"name\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" Login to DockerHub\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"uses\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" docker/login\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"action@v1\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"with\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \"\\n            \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"username\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" $\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \" secrets.DOCKERHUB_USERNAME \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \"\\n            \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"password\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" $\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \" secrets.DOCKERHUB_TOKEN \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \"\\n\\n        \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"name\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" PrepareReg Names\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"id\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" read\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"docker\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"image\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"identifiers\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"run\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"|\"\n        }), _jsx(_components.span, {\n          className: \"token scalar string\",\n          children: \"\\n            echo VERSION_TAG=$(echo ${{ steps.version_step.outputs.version_tag }} | tr '[:upper:]' '[:lower:]') \u003e\u003e $GITHUB_ENV\\n            echo LASTEST_TAG=$(echo ${{ steps.version_step.outputs.latest_tag  }} | tr '[:upper:]' '[:lower:]') \u003e\u003e $GITHUB_ENV\"\n        }), \"\\n        \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"name\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" Build and push\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"id\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" docker_build\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"uses\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" docker/build\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"push\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"action@v2\\n        \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"with\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \"\\n            \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"push\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token boolean important\",\n          children: \"true\"\n        }), \"\\n            \", _jsx(_components.span, {\n          className: \"token key atrule\",\n          children: \"tags\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"|\"\n        }), _jsx(_components.span, {\n          className: \"token scalar string\",\n          children: \"\\n            ${{env.VERSION_TAG}}\\n            ${{env.LASTEST_TAG}}\\n            build-args: |\\n            ${{steps.version_step.outputs.version}}\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Replace Variables in the environment with \", _jsx(_components.strong, {\n        children: \"$\"\n      }), \" ( \", _jsx(_components.a, {\n        href: \"https://github.com/Ja7ad/golang-pipeline/blob/main/.github/workflows/push.yml\",\n        children: \"example push.yml\"\n      }), \" )\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The workflow config is quite simple. You will notice there are two jobs, one called \", _jsx(_components.strong, {\n        children: \"test\"\n      }), \" and one called \", _jsx(_components.strong, {\n        children: \"deploy\"\n      }), \". The \", _jsx(_components.strong, {\n        children: \"test\"\n      }), \" job has one step that uses an if to make sure it only runs when changes are pushed to the main branch or a tag is pushed.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The deploy job requires the test job to run first so that if the tests fail, the Docker image will not be built. If the test job does pass, the remaining steps will run. The first step extracts the version number from a git tag that has the following format \", _jsx(_components.strong, {\n        children: \"v1.0.0\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The next two steps setup the environment so that Docker images can be built. Finally, a step is run that signs into your Docker Hub account using the credentials stored in GitHub Secrets, then the Docker image is built and pushed to Docker Hub.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"You Can see you run action pipeline in \", _jsx(_components.strong, {\n        children: _jsx(_components.a, {\n          href: \"https://github.com/USERNAME/golang-pipeline/actions\",\n          children: \"https://github.com/USERNAME/golang-pipeline/actions\"\n        })\n      }), \" your repo.\"]\n    }), \"\\n\", _jsxs(_components.h1, {\n      id: \"5-create-dockerfile\",\n      children: [_jsx(_components.a, {\n        \"aria-hidden\": \"true\",\n        tabIndex: \"-1\",\n        href: \"#5-create-dockerfile\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), _jsx(_components.a, {\n        href: \"#5-create-dockerfile\"\n      }), \"5. Create Dockerfile\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Now we need to create a \", _jsx(_components.strong, {\n        children: \"Dockerfile\"\n      }), \" for the GitHub action to use when building the image. Create a file called \", _jsx(_components.strong, {\n        children: \"Dockerfile\"\n      }), \" at the root of the repo.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"$ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"touch\"\n        }), \" Dockerfile\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Add the following to the \", _jsx(_components.strong, {\n        children: \"Dockerfile\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-dockerfile\",\n      children: _jsxs(_components.code, {\n        className: \"language-Dockerfile\",\n        children: [_jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"FROM\"\n        }), \" golang\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \"1.16.4\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"buster AS builder\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"ARG\"\n        }), \" VERSION=dev\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"WORKDIR\"\n        }), \" /go/src/app\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"COPY\"\n        }), \" main.go .\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"RUN\"\n        }), \" go build \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"o main \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"ldflags=\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"X=main.version=$\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"VERSION\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \" main.go\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"FROM\"\n        }), \" debian\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \":\"\n        }), \"buster\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"slim\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"COPY\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"-\"\n        }), \"from=builder /go/src/app/main /go/bin/main\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"ENV\"\n        }), \" PATH=\", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"/go/bin:${PATH}\\\"\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"CMD\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"[\"\n        }), _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"main\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"]\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The config above uses a multi-stage build process to build the Go app then copy it to a slim Debian image. If you want to make the image smaller, you can change it to alpine or scratch.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's test the \", _jsx(_components.strong, {\n        children: \"Dockerfile\"\n      }), \" by building it with the following command:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"    $ docker build -t golang-pipeline:dev \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \".\"\n        }), \"\\n\\n    Sending build context to Docker daemon  \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"114\"\n        }), \".2kB\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"1\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" FROM golang:1.16.4-buster AS builder\\n    \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"1.16\"\n        }), \".4-buster: Pulling from library/golang\\n    d960726af2be: Pull complete\\n    e8d62473a22d: Pull complete\\n    8962bc0fad55: Pull complete\\n    65d943ee54c1: Pull complete\\n    f2253e6fbefa: Pull complete\\n    6d7fa7c7d5d3: Pull complete\\n    e2e442f7f89f: Pull complete\\n    Digest: sha256:ab32429d40c1b734ed4f036838ac516352182f9414563478fa88a1553c4a4414\\n    Status: Downloaded newer image \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"for\"\n        }), \" golang:1.16.4-buster\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 96129f3766cf\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"2\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" ARG \", _jsx(_components.span, {\n          className: \"token assign-left variable\",\n          children: \"VERSION\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \"dev\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" Running \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"in\"\n        }), \" 819610ae34de\\n    Removing intermediate container 819610ae34de\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 9eec806043be\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"3\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" WORKDIR /go/src/app\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" Running \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"in\"\n        }), \" 46c0cf6a36b4\\n    Removing intermediate container 46c0cf6a36b4\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 1f1f66dfcc4f\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"4\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" COPY main.go \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \".\"\n        }), \"\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 963a3bcf262b\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"5\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" RUN go build -o main -ldflags\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \"-X\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \"main.version\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), _jsx(_components.span, {\n          className: \"token variable\",\n          children: \"${VERSION}\"\n        }), \" main.go\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" Running \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"in\"\n        }), \" c18447aa254a\\n    Removing intermediate container c18447aa254a\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 3d5364678624\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"6\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" FROM debian:buster-slim\\n    buster-slim: Pulling from library/debian\\n    69692152171a: Pull complete\\n    Digest: sha256:f077cd32bfea6c4fa8ddeea05c53b27e90c7fad097e2011c9f5f11a8668f8db4\\n    Status: Downloaded newer image \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"for\"\n        }), \" debian:buster-slim\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 80b9e7aadac5\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"7\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" COPY --from\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \"builder /go/src/app/main /go/bin/main\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" f96694436dca\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"8\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" ENV \", _jsx(_components.span, {\n          className: \"token assign-left variable\",\n          children: _jsx(_components.span, {\n            className: \"token environment constant\",\n            children: \"PATH\"\n          })\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), _jsxs(_components.span, {\n          className: \"token string\",\n          children: [\"\\\"/go/bin:\", _jsxs(_components.span, {\n            className: \"token variable\",\n            children: [\"${\", _jsx(_components.span, {\n              className: \"token environment constant\",\n              children: \"PATH\"\n            }), \"}\"]\n          }), \"\\\"\"]\n        }), \"\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" Running \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"in\"\n        }), \" 0423a0a1b60a\\n    Removing intermediate container 0423a0a1b60a\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 8ac59bcbe805\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"9\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" CMD \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"[\"\n        }), _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"main\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"]\"\n        }), \"\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" Running \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"in\"\n        }), \" 1491bcf193c6\\n    Removing intermediate container 1491bcf193c6\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 190ba9407211\\n    Successfully built 190ba9407211\\n    Successfully tagged golang-pipeline:dev\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Now run the image and see if it prints the incorrect string \", _jsx(_components.strong, {\n        children: \"Hello Golang\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsx(_components.code, {\n        className: \"language-bash\",\n        children: \"    $ docker run --rm golang-pipeline:dev\\n\\n    Version: dev\\n    Hello golang\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We can assign a version to the image by using \", _jsx(_components.code, {\n        children: \"--build-arg VERSION=1.0.0\"\n      }), \" while building the image. For example:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"    $ docker build -t golang-pipeline:1.0.0 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \".\"\n        }), \" --build-arg \", _jsx(_components.span, {\n          className: \"token assign-left variable\",\n          children: \"VERSION\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), _jsx(_components.span, {\n          className: \"token number\",\n          children: \"1.0\"\n        }), \".0\\n\\n    Sending build context to Docker daemon  \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"114\"\n        }), \".2kB\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"1\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" FROM golang:1.16.4-buster AS builder\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 96129f3766cf\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"2\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" ARG \", _jsx(_components.span, {\n          className: \"token assign-left variable\",\n          children: \"VERSION\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \"dev\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" Using cache\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 9eec806043be\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"3\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" WORKDIR /go/src/app\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" Using cache\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 1f1f66dfcc4f\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"4\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" COPY main.go \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \".\"\n        }), \"\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" Using cache\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 963a3bcf262b\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"5\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" RUN go build -o main -ldflags\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \"-X\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \"main.version\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), _jsx(_components.span, {\n          className: \"token variable\",\n          children: \"${VERSION}\"\n        }), \" main.go\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" Running \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"in\"\n        }), \" 352fb8de7969\\n    Removing intermediate container 352fb8de7969\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 0950776088fa\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"6\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" FROM debian:buster-slim\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 80b9e7aadac5\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"7\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" COPY --from\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \"builder /go/src/app/main /go/bin/main\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 91938ce4f326\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"8\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" ENV \", _jsx(_components.span, {\n          className: \"token assign-left variable\",\n          children: _jsx(_components.span, {\n            className: \"token environment constant\",\n            children: \"PATH\"\n          })\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), _jsxs(_components.span, {\n          className: \"token string\",\n          children: [\"\\\"/go/bin:\", _jsxs(_components.span, {\n            className: \"token variable\",\n            children: [\"${\", _jsx(_components.span, {\n              className: \"token environment constant\",\n              children: \"PATH\"\n            }), \"}\"]\n          }), \"\\\"\"]\n        }), \"\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" Running \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"in\"\n        }), \" 44541fe9de77\\n    Removing intermediate container 44541fe9de77\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" c8924b6b45b3\\n    Step \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"9\"\n        }), \"/9 \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \":\"\n        }), \" CMD \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"[\"\n        }), _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"main\\\"\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"]\"\n        }), \"\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" Running \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"in\"\n        }), \" 424b93b94419\\n    Removing intermediate container 424b93b94419\\n     ---\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"\u003e\"\n        }), \" 9da417e7399b\\n    Successfully built 9da417e7399b\\n    Successfully tagged golang-pipeline:1.0.0\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The docker image built can be found here:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"    $ docker images\\n\\n    REPOSITORY                TAG             IMAGE ID       CREATED          SIZE\\n    golang-pipeline           \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"1.0\"\n        }), \".0           9da417e7399b   \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"22\"\n        }), \" seconds ago   \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"71\"\n        }), \".2MB\\n    golang-pipeline           dev             190ba9407211   \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"3\"\n        }), \" minutes ago    \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"71\"\n        }), \".2MB\\n    golang                    \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"1.16\"\n        }), \".4-buster   96129f3766cf   \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"2\"\n        }), \" weeks ago      862MB\\n    debian                    buster-slim     80b9e7aadac5   \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"2\"\n        }), \" weeks ago      \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"69\"\n        }), \".2MB\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The reason this works, is because we use \", _jsx(_components.code, {\n        children: \"-ldflags\"\n      }), \" to modify the version variable at compile time. The \", _jsx(_components.code, {\n        children: \"--build-arg\"\n      }), \" assigns the version to \", _jsx(_components.strong, {\n        children: \"VERSION\"\n      }), \" and is used in the following line:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"    RUN go build -o main -ldflags\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \"-X\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \"main.version\", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), _jsx(_components.span, {\n          className: \"token variable\",\n          children: \"${VERSION}\"\n        }), \" main.go\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Okay, we are now ready to push our code to the GitHub repository.\"\n    }), \"\\n\", _jsxs(_components.h1, {\n      id: \"6-push-code-to-main\",\n      children: [_jsx(_components.a, {\n        \"aria-hidden\": \"true\",\n        tabIndex: \"-1\",\n        href: \"#6-push-code-to-main\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), _jsx(_components.a, {\n        href: \"#6-push-code-to-main\"\n      }), \"6. Push Code to Main\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now that we know our project builds and we have created a repository, we are ready to push our code to the main branch. Letâ€™s initialise Git, commit our changes, add the origin, and push the changes by running the following commands (replace the repo URL with your own):\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"    $ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"git\"\n        }), \" init\\n    $ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"git\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"add\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \".\"\n        }), \"\\n    $ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"git\"\n        }), \" commit -m \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"first commit\\\"\"\n        }), \"\\n    $ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"git\"\n        }), \" remote \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"add\"\n        }), \" origin git@github.com:USERNAME/golang-pipeline\\n    $ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"git\"\n        }), \" branch -M main\\n    $ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"git\"\n        }), \" push -u origin main\\n\"]\n      })\n    }), \"\\n\", _jsxs(_components.h1, {\n      id: \"7-check-build-failed\",\n      children: [_jsx(_components.a, {\n        \"aria-hidden\": \"true\",\n        tabIndex: \"-1\",\n        href: \"#7-check-build-failed\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), _jsx(_components.a, {\n        href: \"#7-check-build-failed\"\n      }), \"7. Check Build Failed\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Go to your GitHub repository and click \", _jsx(_components.strong, {\n        children: \"Actions\"\n      }), \". We should see the GitHub action running. Since we are pushing to the main branch, it will run the \", _jsx(_components.strong, {\n        children: \"test\"\n      }), \" job and it should fail.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.img, {\n        src: \"/images/notes/ga_build_fail.png\",\n        alt: \"Github Action test fail_\"\n      }), \"\\n\", _jsx(_components.em, {\n        children: \"Github Action test fail\"\n      })]\n    }), \"\\n\", _jsxs(_components.h1, {\n      id: \"8-fix-code-so-test-passes\",\n      children: [_jsx(_components.a, {\n        \"aria-hidden\": \"true\",\n        tabIndex: \"-1\",\n        href: \"#8-fix-code-so-test-passes\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), _jsx(_components.a, {\n        href: \"#8-fix-code-so-test-passes\"\n      }), \"8. Fix Code so Test Passes\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's fix the broken test.\\nOpen \", _jsx(_components.strong, {\n        children: \"main.go\"\n      }), \" and modify the return value of the \", _jsx(_components.code, {\n        children: \"hello\"\n      }), \" function so that it returns \", _jsx(_components.code, {\n        children: \"Hello Golang\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"    $ go \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \"test\"\n        }), \"\\n\\n    PASS\\n    ok      hello   \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"0\"\n        }), \".003s\\n\\n\\nCommit and push the changes.\\n\\n    $ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"git\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"add\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token builtin class-name\",\n          children: \".\"\n        }), \"\\n    $ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"git\"\n        }), \" commit - \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"\\\"Fix hello function return value\\\"\"\n        }), \"\\n    $ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"git\"\n        }), \" push\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The GitHub action should run again and now the test will pass.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.img, {\n        src: \"/images/notes/ga_test_successfully.png\",\n        alt: \"Github Action test fail_\"\n      }), \"\\n\", _jsx(_components.em, {\n        children: \"Github Action test successfully\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.img, {\n        src: \"/images/notes/ga_status.png\",\n        alt: \"Github Action test fail_\"\n      }), \"\\n\", _jsx(_components.em, {\n        children: \"Github Action status\"\n      })]\n    }), \"\\n\", _jsxs(_components.h1, {\n      id: \"9-push-tag\",\n      children: [_jsx(_components.a, {\n        \"aria-hidden\": \"true\",\n        tabIndex: \"-1\",\n        href: \"#9-push-tag\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), _jsx(_components.a, {\n        href: \"#9-push-tag\"\n      }), \"9. Push Tag\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Now that we know the test passes, let's push a release tag. We will tag this version as \", _jsx(_components.strong, {\n        children: \"v1.0.0\"\n      })]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash\",\n        children: [\"    $ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"git\"\n        }), \" tag v1.0.0\\n    $ \", _jsx(_components.span, {\n          className: \"token function\",\n          children: \"git\"\n        }), \" push --tags\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"After pushing the tags, the GitHub action will run again and this time it will build the Docker image and push it to your Docker Hub repository.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{"title":"Build CI/CD pipelines in Go with github actions and Docker","description":"Build CI/CD pipelines in Go with github actions and Docker","publishedTime":"2024-01-30","modifiedTime":"2024-01-30","image":"/images/gopher-github-actions.jpeg"}},"frontMatter":{"title":"Build CI/CD pipelines in Go with github actions and Docker","description":"Build CI/CD pipelines in Go with github actions and Docker","publishedTime":"2024-01-30","modifiedTime":"2024-01-30","image":"/images/gopher-github-actions.jpeg"}},"__N_SSG":true},"page":"/notes/[slug]","query":{"slug":"ci-cd-pipelines-in-go-with-docker-and-github-actions"},"buildId":"HqLUniL5FVtfX-QYTfP9O","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>